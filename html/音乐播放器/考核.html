<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>考核</title>
</head>

<body>

    <div class="box">
        <div class="box1">
            <div class="container">
                <ul class="lrc-list"></ul>
            </div>
        </div>
        <div class="box2">
            <audio controls src="https://music.163.com/song/media/outer/url?id=33894312.mp3"></audio>
      
        </div>
    </div>

    <div class="anniu" style="margin-top: 15px;">
        <button class="a1">上一首</button>
        <button class="a2">下一首</button>
      </div>
    <style>
        .box {
            width: 300px;
            height: 500px;
            border: 1px solid #000;
            border-radius: 15px;
            margin: 0 auto;
            color: aliceblue;
            background-color: #000;
            text-align: center;
          
        }

        .box1 {
            width: 100%;
            height: 420px;
            border-bottom: 1px solid #000; 
             line-height: 420px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-size: 12px;
        }

        li {
            list-style: none;
        }

        body {
            width: 100vw;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;        
            padding: 50px;
            color: #666;
            text-align: center;
        }
  
        .container {
            width: 100%;
            height: 420px;        
            display: flex;
            flex-direction: column;
            margin-top: 30px;
            overflow: hidden;
        }

        .container ul {
            transition: all 0.3s ease-in;
        }

        .container li {
            transition: all 0.3s ease;
            height: 30px;
            line-height: 30px;
        }

        .container li.active {
            transform: scale(1.4);
            color: #f20b0b;
        }
    </style>


    <script>
        var lrc = "[00:00.00] 作词 : 梨冻紧/Wiz_H张子豪\n[00:01.00] 作曲 : 梨冻紧/Wiz_H张子豪\n[00:02.00] 编曲 : Wiz_H张子豪\n[00:03.00] 钢琴 : 梨冻紧\n[00:04.00] 封面 : 蓝明初\n[00:05.00] 混音 : 官硕\n[00:06.00] 母带 : Mai＂ No Label Crew＂\n[00:07.00] 监制 : Mai＂ No Label Crew＂\n[00:08.00] 发行 : No Label Crew\n[00:09.00] 企划 : 苏文嫒 张琛\n[00:20.85]作词:梨冻紧/ Wiz_ H张子豪\n[00:21.78]作曲:梨冻紧\n[00:26.37]专辑封面蓝明初\n[00:26.85]编曲： wiz_ h\n[00:27.24]混音：官硕\n[00:27.54]母带： Mai＂ No Label Crew＂\n[00:28.32]监制： Mai＂ No Label Crew＂\n[00:30.60]我没转身\n[00:31.71]一直走一直梦\n[00:33.69]一直疯一直没停留\n[00:37.83]那些美好的\n[00:39.27]越靠近越沉溺\n[00:41.22]越来越不想放手\n[00:45.99] Wherever you go\n[00:53.13] Wherever you go\n[01:01.26] Follow\n[01:02.04]每到晚上理智变得感性\n[01:04.44]我编了这条短信\n[01:05.67]说不在乎不过是我嘴硬\n[01:07.65]总是期待你有什么反应\n[01:09.48]对你没法保持那份冷静\n[01:11.22]偷偷想着我们之间关系的远近\n[01:13.23]我的心里没有任何的侥幸\n[01:14.85]我知道我的爱对你来说就好像软禁\n[01:16.74]我们都闭口不提\n[01:18.42]这跨不过的距离\n[01:20.04]我们不停的一再复习着\n[01:22.02]那些感情里俗套的剧情\n[01:23.76]你那里是怎么样的天气\n[01:25.74]夜空是否还是那么透明\n[01:27.51]我说的又开始不着了边际\n[01:29.52]可是没有你我真的不行\n[01:31.14]就请你\n[01:32.19]把我当成贪得无厌\n[01:34.11]把我当作得寸进尺\n[01:35.79]每当难过表情在你脸上浮现\n[01:37.65]我也难过得像照着一面镜子\n[01:39.51]多么希望和你在一起的时间\n[01:41.46]那些快乐可以突然静止\n[01:43.26]多么希望时间可以快点\n[01:44.97]带我和你一起体验生老和病死\n[01:46.77]我想过下次会更好\n[01:48.15]也开始更加了解了你的脾气\n[01:50.31]可是下次我们还是争吵\n[01:52.02]下次可能还是不留余地\n[01:54.00]我爱你不遗余力\n[01:55.59]在爱里不停期待奇迹\n[01:57.57]不忍看你这么痛苦\n[01:59.25]又不愿离去\n[02:00.69] and i will\n[02:01.29] Follow\n[02:01.83]一直走一直梦\n[02:03.66]一直疯一直没停留\n[02:07.83]那些美好的\n[02:09.27]越靠近越沉溺\n[02:11.19]越来越不想放手\n[02:15.60] Wherever you go\n[02:23.13] Wherever you go\n[02:32.61] Wherever you go\n[02:34.44] Wherever you go\n[02:36.48]一直都搞不定自己的情绪在你走后\n[02:40.05] Wherever you go\n[02:41.88] just want you to know\n[02:43.95]你知道我的心一直都在原地为你等候\n[02:46.65]其实对天气不感兴趣\n[02:48.15]想知道你会不会太冷\n[02:50.28]没法完成那份陪伴\n[02:51.78]孤独你会不会在忍\n[02:53.79]不知道想念你的痛苦\n[02:55.50]来的到底会不会太准\n[02:57.36]只知道当你不在床上\n[02:59.25]我总是睡得不会太稳\n[03:01.53]我们看惯了世间的罗生门\n[03:03.45]变得好像陌生人\n[03:05.28]两颗同样不安的心脏被塞进了同一个摩天轮\n[03:09.03]每次拥抱停留在清晨\n[03:10.98]窗外大雨在倾盆\n[03:12.75]我们好像巨大城市里面两个相爱的外星人\n[03:16.53]可我不想生活在套路里\n[03:18.45]想把心事都告诉你\n[03:19.86]我想要一直照顾你\n[03:21.72]又总害怕你耗不起\n[03:24.54]滴答的秒针又在\n[03:26.16]提醒我爱你几分\n[03:28.23]只要听到你的声音\n[03:29.73]我一定会为你转身\n[03:31.74]一直走一直梦\n[03:33.66]一直疯一直没停留\n[03:37.86]那些美好的\n[03:39.27]越靠近越沉溺\n[03:41.22]越来越不想放手\n[03:45.66] Wherever you go\n[03:46.89] Wherever you go\n[03:47.22]发行： No Label Crew\n[03:47.64]企划：苏文嫒张琛\n[03:51.12]营销推广：贾皓然欧阳慧琳苏文嫒\n[03:58.83]本歌曲来自【青云 LAB】\n[03:59.83] 营销企划：贾皓然 小盐 崇高"
        const lrcData = formatLrc(lrc)
        const audio = document.querySelector('audio')
        const container = document.querySelector('.container')
        const ul = document.querySelector('.lrc-list')
        const containerHeight = container.clientHeight
        function formatLrc(data) {
            const lrcs = []
            const lrc = data.split('\n').forEach(item => {
                lrcs.push({
                    time: formatTime(item),
                    lrc: item.split(']')[1]
                })
            })
            return lrcs
        }
        function formatTime(str) {
            const res = str.split(']')[0].substring(1)
            return res.split(':')[0] * 60 + res.split(':')[1] * 1
        }
        function monitorAudio() {
            const currentAudioTime = audio.currentTime
            const index =
                lrcData.findIndex(item => {
                    return item.time > currentAudioTime
                }) - 1
            return index < 0 ? lrcData.length - 1 : index
        }
        function createLrcElement() {
            const frag = document.createDocumentFragment()
            lrcData.forEach(item => {
                const li = document.createElement('li')
                li.innerText = item.lrc
                frag.appendChild(li)
            })
            ul.appendChild(frag)
        }
        createLrcElement()
        const liHeight = ul.children[0].clientHeight
        const maxUpLength = lrcData.length * liHeight - containerHeight
        function setUpLength() {
            const index = monitorAudio()
            let upLength = liHeight * index + liHeight / 2 - containerHeight / 2
            if (upLength < 0) {
                upLength = 0
            }
            if (upLength > maxUpLength) {
                upLength = maxUpLength
            }
            ul.style.transform = `translateY(-${upLength}px)`
            const lis = [...ul.children]
            lis.forEach(item => {
                item.classList.remove('active')
            })
            const li = ul.children[index]
            if (li) {
                li.classList.add('active')
            }
        }
        audio.addEventListener('timeupdate', function () {
            setUpLength()
        })
        document.querySelector('.a2').addEventListener('click', function () {
            // 替换歌词
            var newLyric = 
                "[00:00.000] 新歌词开始\n[00:05.000] 这是一首新歌\n[00:10.000] 希望你喜欢\n[00:15.000] 更多精彩内容\n";

            var newArr = newLyric.split("\n").filter((item) => item);

            var newParsedLyric = newArr.map(function (item) {
                var res = item.match(/\[(?<m>\d{2}):(?<s>\d{2}\.\d{3})\](?<str>.*)/i);
                return {
                    time: parseInt(res.groups.m, 10) * 60 + parseFloat(res.groups.s),
                    text: res.groups.str.trim() || "---",
                };
            });

            // 清空原来的歌词
            lyricsContainer.innerHTML = '';

            // 添加新歌词到容器中
            newParsedLyric.forEach(line => {
                var li = document.createElement("li");
                li.innerText = line.text;
                li.classList.add("lyric-line");
                lyricsContainer.appendChild(li);
            });
        });
    </script>
</body>

</html>